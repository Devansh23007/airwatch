<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AirWatch</title>
  <link rel="stylesheet" href="/static/style.css">
</head>

<body class="index-page">

<header class="main-header center">
  <h1>
    <span class="grad">Air Quality</span><br>
    Intelligence
  </h1>
  <p>Smart Campus â€“ Live Air Monitoring</p>
</header>

<section class="building-select">

  <div class="building-card card-anviksha" onclick="go('Anviksha')">
    <h2>Anviksha</h2>
    <div class="aqi-preview" id="aqi-Anviksha">AQI: --</div>
  </div>

  <div class="building-card card-sot" onclick="go('SOT')">
    <h2>SOT</h2>
    <div class="aqi-preview" id="aqi-SOT">AQI: --</div>
  </div>

  <div class="building-card card-sos" onclick="go('SOS')">
    <h2>SOS</h2>
    <div class="aqi-preview" id="aqi-SOS">AQI: --</div>
  </div>

</section>

<script>
function go(name) {
  window.location.href = `/building/${name}`;
}

function getColor(aqi) {
  if (aqi <= 50) return "green";
  if (aqi <= 100) return "yellow";
  if (aqi <= 200) return "orange";
  return "red";
}

function updateAQI(name) {
  fetch(`/api/building/${name}`)
    .then(res => res.json())
    .then(data => {
      const el = document.getElementById(`aqi-${name}`);
      el.innerText = `AQI: ${data.AQI}`;

      const card = el.parentElement;
      card.classList.remove("green","yellow","orange","red");
      card.classList.add(getColor(data.AQI));
    });
}

["Anviksha","SOT","SOS"].forEach(updateAQI);

setInterval(() => {
  ["Anviksha","SOT","SOS"].forEach(updateAQI);
}, 3000);
</script>

</body>
</html>
